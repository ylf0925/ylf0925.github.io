---
title: 前端学习week14
date: 2019-08-04 22:38:29
comments: false
tags:
- javascript
- front-end
mathjax: false
---

​	本周主要学习了正则表达式的基础知识，细节和小知识点非常非常多，看记录的内容就知道了，主要的学习目的还是能看懂和理解正则表达式以及js常用的正则api及其原理，例如正则对象的exec，test以及字符串的match和replace，不强求写出优雅简洁的正则，毕竟智商有限。此外简单介绍了日期类型和es6的增强字符串-反引号

<!-- more -->

### 正则表达式

- 正则表达式也是一种对象类型
  - 构造函数RegExp
    - 用构造函数创建注意反斜杠的规则和字符串相同
  - 字面量创建，两边用斜杠包围
    - 斜杠是结束标值，所以表达式包含斜杠时，需要在前面加反斜杠
  - source属性，包含创建正则表达式的字符串，不包括//及外面的flags
  - lastIndex属性，可写属性，控制下一次匹配开始的位置，**只有当使用设置了g的时候才能被更新和修改，且只对exec和test生效**，匹配失败会被重置为0
- 中括号只匹配一个字符，匹配中括号中任一字符
  - 可以用连字符`-`指定范围，按unicode顺序，单独的`-`表示它自己
  - `.`在中括号中没有其他含义只表示其自己，其他特殊字符也是，比如`+ * `
  - `^`脱字符出现在最前面表示取非，不在最前面没有其他含义，`[^]`表示匹配全集
- `+`前面元素至少重复一次，`*`重复至少0次，`?`前面元素出现1次或0次，`{}`内加数字或范围表示重复具体次数，前面的元素加`()`使多个元素重复
- 表达式末尾`i`表示不区分大小写`/xxx/i`
- 表达式末尾`g`表示全局匹配输入字符串中所有能匹配的项**默认匹配第一个项就结束匹配**`/xxx/g`
  - 如果匹配的字符串有交叉，例如用`/abcabc/g`匹配`abcabcabc`只会匹配第一个匹配项，不会匹配交叉的第二个
- 脱字符`^` 用在开头表示输入字符串的起始位置，`$`表示字符串结束位置，`/^xxx$/`则输入字符串必须从头至尾满足条件
- `\bxxxxx\b` 单词边界，包裹的元素是一个独立单词，字符串的起始结束位置都是数字/字母/下划线(即`\w`表示的字符)
- `(?:)`匹配项不会作为分组，结果不会出现在exec的结果数组中
- `(?<name>)`可以给分组命名，只有自命名的分组的匹配项会出现在exec的group属性中
- 零宽断言
  - 匹配两个符号之间的一个位置而不是符号，宽度为0
  - 可以对同一个位置执行多个零宽断言匹配
  - 零宽断言**不是**分组
  - `/(?=foo)/`匹配到字符串中foo开始的位置    
  - `/(?!foo)/`位置后面不能匹配foo
  - `/(?<=)/`位置左边匹配xxxxx
    - 回顾断言中有重复符，则贪婪模式是从右向左满足
    - 分组时和正常一样是从左向右分配和自动命名的的，但反向代理的`\n`需要放在分组的左边才能生效，即分配时是从左往右，扫描匹配时是从右往左
  - `/(?<!)/`
  - 例：
    - `^ === /(?<![^])/`
    - `$ === /(?![^])/`
    - `\b === (?<=\w)(?=\W)|(?<=\W)(?=\w)|(?<![^])|(?![^])`
- 管道符`|`   表示或，需要用括号来限制其选项范围
- 记住正则的实现是从前向后按步进行的，回溯只存在于当前匹配不成功的情况

#### 反向引用

- 前面分组匹配结束时，自动命名的分组可以用`\n`引用匹配项
- 任何情况下都是以正则表达式中**开始括号的顺序**作为分组的顺序，即使用了`|`运算符
- 自命名分组可以用`\k<name>`反向引用，同时也可以用`\n`

#### 方法

- test
  - 接受字符串，返回布尔值，存在匹配项就返回true
- exec
  - 无匹配返回null，否则返回匹配信息对象
  - 返回的对象是字符串组成的数组，包含整体及所有圆括号的分组，重复分组则保留最后一次，重复0次的保留undefined，增加了index，groups，input属性
  - group属性是一个对象包含自命名分组及其匹配项的键值对
  - exec设置了全局g也只会先返回第一个匹配项(同时更新lastIndex属性)，继续执行会向后匹配，不设置g多次执行会重复匹配第一项
- `String.prototype.match()`是字符串的方法
  - 参数里的正则使用g，则返回所有完整匹配项的结果数组（不包含分组），形式和普通数组相同
  - 不使用g则返回第一项完整的匹配及其**相关**的分组匹配，形式和exec一样

#### replace

- 字符串的方法，用第二个参数替换第一个正则参数匹配到的字符串，第二个参数可以为函数，第一个参数也可以是字符串

- 第二个参数为函数时，传入的参数依次为exec执行后的结果数组的元素，依次为整体匹配项，各分组捕获项，匹配的index，命名分组，输入的字符串

- 设置g可以全局匹配，**实际是重复执行匹配直到全部匹配结束**

- `$n`是正则自带的分组匹配到的字符串表示方式，不能把它当做完全的字符串看待，只能做增加字符，换位等操作

  - `\n`用在分组开始匹配之前相当于匹配任何位置,即分组还没开始匹配

  - ```js
    /\1/.test('')
    // false
    /\1()/.test('')
    // true
    ```

  - 注意正负回顾零宽断言时的这个规则

#### 贪婪模式

- 模式重复运算符`+ * ? {}`默认是贪婪的，会匹配尽量多的字符直到不能匹配再回溯
- 在模式重复运算符后加`?`变为非贪婪，会匹配尽量少的字符，只有剩下的模式无法匹配才会继续匹配重复
- 使用重复时优先考虑非贪婪

### 日期类型

- 构造函数Date，默认创建当前时间对象
- 自定义时间：月份从0开始，日期从1开始，小时分钟等不设置默认为0
- getTime方法返回1970年开始以毫秒表示的时间戳 ，也可以用时间戳创建对象

### 模板字面量

- 反引(``)号表示的增强版字符串
  - 支持多行，保留所有空白
  - 也可用\n指示换行位置
- 变量占位符
  - 新增特性，由`${}`将变量嵌入字符串，中间可以放任意的表达式，包括运算符函数调用等，注意用反斜杠转义可以使其失效
- 标签模板
  - **String.raw``** 反引号内写入字符串不用考虑转义，所见即所得，输出字符串，任意形式的转义都会失效，保留原样输出
  - 形如上面这个例子，`String.raw`模板标签，实际上它是一个函数，后接模板字面量相当于传参，在控制台我们可以看到它传入参数的形式
    - 第一个参数是一个数组，包含以变量占位符为隔板分隔的各个子串(类似split)，此外该数组还包含一个不可枚举的raw属性包含的数组，内容形式和包含它的数组内容相同，不过字符串内容与输入时的状态完全相同(即转义都不生效且保留转义符，然而变量占位符依然生效)，这也解释了为什么上一个例子会保留输入原样输出(正是利用了raw)
    - 第二及以后的参数为从前到后各变量占位符中表达式的值



###  零碎知识

- 源代码书写字符串的时候才要考虑转义

- 字符串的split方法，参数为正则表达式时，会在各匹配项对应的位置返回**分组捕获的字符串**不会出现整体匹配的字符串

  